### YaMDB Учебный проект Яндекс Практикум

**Описание проекта:**

Проект YaMDb это API для сервиса отзывывов о фильмах и произведениях. 

Использует Django REST Framework и базу данных Postgresql

### Пользовательские роли

-   **Аноним** --- может просматривать описания произведений, читать отзывы и комментарии.
-   **Аутентифицированный пользователь (**`user`**)**--- может читать всё, как и **Аноним**, дополнительно может публиковать отзывы и ставить рейтинг произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы и ставить им оценки; может редактировать и удалять **свои** отзывы и комментарии.
-   **Модератор (**`moderator`**)** --- те же права, что и у **Аутентифицированного пользователя** плюс право удалять **любые** отзывы и комментарии.
-   **Администратор (**`admin`**)** --- полные права на управление проектом и всем его содержимым. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
-   **Администратор Django** --- те же права, что и у роли **Администратор**.

### Алгоритм регистрации пользователей

1.  Пользователь отправляет POST-запрос с параметром `email` на `/api/v1/auth/email/`.
2.  **YaMDB** отправляет письмо с кодом подтверждения (`confirmation_code`) на адрес `email` .
3.  Пользователь отправляет POST-запрос с параметрами `email` и `confirmation_code` на `/api/v1/auth/token/`, в ответе на запрос ему "приходит" `token` (JWT-токен). (Письма появляются в паке **sent_emails**, реальная доставка почты пока не реализована)

Эти операции выполняются один раз, при регистрации пользователя. В результате пользователь получает токен и может работать с API, отправляя этот токен с каждым запросом.

После регистрации и получения токена пользователь может отправить PATCH-запрос на `/api/v1/users/me/` и заполнить поля в своём профайле (описание полей --- в документации).

Если пользователя создаёт администратор (например, через POST-запрос `api/v1/users/...`) --- письмо с кодом отправлять не нужно.


### Ресурсы API **YaMDb**

-   Ресурс **AUTH:** аутентификация.
-   Ресурс **USERS:** пользователи.
-   Ресурс **TITLES:** произведения, к которым пишут отзывы (определённый фильм, книга или песенка).
-   Ресурс **CATEGORIES:** категории (типы) произведений («Фильмы», «Книги», «Музыка»).
-   Ресурс **GENRES**: жанры произведений. Одно произведение может быть привязано к нескольким жанрам.
-   Ресурс **REVIEWS:** отзывы на произведения. Отзыв привязан к определённому произведению.
-   Ресурс **COMMENTS:** комментарии к отзывам. Комментарий привязан к определённому отзыву.


Связанные данные и каскадное удаление
-------------------------------------

При удалении объекта пользователя **User** должны удаляться все отзывы и комментарии этого пользователя (вместе с оценками-рейтингами).

При удалении объекта произведения **Title** должны удаляться все отзывы к этому произведению и комментарии к ним.

При удалении объекта категории **Category** не удалять связанные с этой категорией произведения (**Title)**.

При удалении объекта жанра **Genre** не удалять связанные с этим жанром произведения (**Title)**.

При удалении объекта отзыва **Review** должны быть удалены все комментарии к этому отзыву.


### Для старта с нуля:

Установить [Git](https://github.com/git-guides/install-git)

Установить [Docker](https://docs.docker.com/engine/install/) и [docker-compose](https://docs.docker.com/compose/install/#install-compose)

Склонировать репозитарий `git clone https://github.com/mechnotech/infra_sp2 && cd infra_sp2`

Cоздать файл .env c собственными настройками и паролями  по аналогии с шаблоном .env.example:

Затем там же в паке выполнить `docker-compose up`

Это создаст и запустит два контейнера **db** (Postgresql) и **web** (Django)

Необходимо зайти в контейнер web: 

Открыть в корневой папке проекта новое окно терминала (Alt+Ctrl+T) и выполнить `docker-compose run web bash`

и внутри него выполнить:

- `python3 manage.py migrate`
- `python3 manage.py createsuperuser` (по желанию, чтоб управлять через админку)
- `python3 manage.py loaddata fixtures.json` - (по желанию, заполняет тестовыми данными базу данных)

Сервис будет доступен по адресу 127.0.0.1:8000

Админка 127.0.0.1:8000/admin

Над проектом работали: Евгений Шумилов, Александр Иванов, Дмитрий Морозов

Для контактов: vk.com/mech2045 
